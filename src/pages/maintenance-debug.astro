---
import { loadTasks, suggestUpcomingTasks, exportTasks, appendHistory, decorateTasks } from '../lib/maintenance.ts';
// Exercise unused functions to clear warnings.
const referenceDate = new Date();
// Ephemeral history append (non-persistent) for debug usage.
appendHistory('engine-oil-change', { date: referenceDate.toISOString().substring(0,10), action: 'unblocked' });
const suggestions = suggestUpcomingTasks(referenceDate, 'owner', 5);
const ownerExport = exportTasks('owner', referenceDate);
const publicExport = exportTasks('public', referenceDate);
const tasks = decorateTasks(loadTasks(), referenceDate);
---
<layout>
  <h1>Maintenance Debug</h1>
  <section>
    <h2>Upcoming Suggestions</h2>
    <ul>
      {suggestions.map(t => <li>{t.id} · {t.nextDue} · {t.overdue ? 'OVERDUE' : (t.daysUntilDue ?? 'n/a') + 'd'}</li>)}
    </ul>
  </section>
  <section>
    <h2>Owner Export (Sample)</h2>
    <pre style="font-size:0.7rem; max-height:300px; overflow:auto;">{JSON.stringify(ownerExport.tasks.slice(0,3), null, 2)}</pre>
  </section>
  <section>
    <h2>Public Export (Sample)</h2>
    <pre style="font-size:0.7rem; max-height:300px; overflow:auto;">{JSON.stringify(publicExport.tasks.slice(0,3), null, 2)}</pre>
  </section>
  <section>
    <h2>Task Count</h2>
    <p>Total tasks: {tasks.length}</p>
  </section>
  <p class="note">This debug page is for development only and may be removed before archiving.</p>
</layout>
<style>
  h1 { margin-top:1.5rem; }
  pre { background:#f5f5f5; padding:0.5rem; border-radius:6px; }
  .note { font-size:0.65rem; color:#666; }
</style>

