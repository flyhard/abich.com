---
import Layout from '../layouts/Layout.astro';
import CVHeader from '../components/CVHeader.astro';
import CVSection from '../components/CVSection.astro';
import CVExperienceList from '../components/CVExperienceList.astro';
import CVSkills from '../components/CVSkills.astro';

// CV Visibility Configuration
const cvVisibility = import.meta.env.CV_VISIBILITY || 'shareable';

// Redirect to 404 if CV is hidden
if (cvVisibility === 'hidden') {
  return Astro.redirect('/404');
}

// Determine robots meta tag based on visibility mode
const robotsMeta = cvVisibility === 'shareable'
  ? 'noindex, nofollow'
  : 'index, follow';

// Per Abich's actual CV data from PDF
const personalInfo = {
  name: "Per Abich",
  title: "Software Engineer - Java & Spring",
  email: "per.abich@example.com", // Update with your actual email
  phone: "+46 70 123 45 67", // Update with your actual phone
  location: "Stockholm, Sverige",
  linkedin: "linkedin.com/in/perabich",
  github: "github.com/perabich"
};

const experiences = [
  {
    startDate: "2022-05",
    endDate: null,
    company: "Avanza Bank",
    role: "Software Engineer",
    location: "Stockholm, Sverige",
    description: "Utvecklar webapplikationer med Java och Spring Framework för en av Sveriges största nätbanker. Arbetar med skalbar backend-utveckling och finansiella system."
  },
  {
    startDate: "2017-12",
    endDate: "2022-05",
    company: "Unikum - Net AB",
    role: "Back End Developer",
    location: "Stockholm, Sverige",
    description: "Utvecklade backend-gränssnitt för huvudapplikationen och mindre verktyg för Ops-arbete. Arbetade med CI-pipeline och deployment-skript. Huvudapplikationen är en Java-applikation med flera Microservices, deployment i Python och verktyg ofta skrivna i Go."
  },
  {
    startDate: "2015-10",
    endDate: "2017-12",
    company: "IG",
    role: "Senior Developer - Performance and Reliability Engineering Team",
    location: "London, United Kingdom",
    description: "Arbetade med site reliability engineering och support för legacy-applikationer. Fokus på prestanda och tillförlitlighet i storskaliga finansiella system."
  },
  {
    startDate: "2012-04",
    endDate: "2015-10",
    company: "Visma Consulting",
    role: "Seniorkonsulent",
    location: "Norge",
    description: "Senior konsultuppdrag inom systemutveckling och teknisk rådgivning för företagskunder."
  },
  {
    startDate: "2009-10",
    endDate: "2012-03",
    company: "Quality Manager Plus com AS",
    role: "Systems Developer",
    location: "Norge",
    description: "Utveckling av webbaserad applikation med Java. Huvudsakligen utveckling av Servlets med Spring MVC och implementation av Spring Security."
  },
  {
    startDate: "2008-07",
    endDate: "2009-12",
    company: "ICA Norge AS",
    role: "System Engineer",
    location: "Norge",
    description: "Systemingenjör med ansvar för teknisk infrastruktur och systemunderhåll."
  },
  {
    startDate: "2006-11",
    endDate: "2008-06",
    company: "pdvcom Beratungs-GmbH",
    role: "Consultant",
    location: "Tyskland",
    description: "Konsultuppdrag inom systemutveckling och teknisk rådgivning."
  },
  {
    startDate: "1997-08",
    endDate: "2001-07",
    company: "Oracle",
    role: "Consultant",
    location: "Oslo, Norge",
    description: "Konsultuppdrag för Oracle med fokus på databasutveckling och systemintegration."
  }
];

const education = [
  {
    startDate: "2002",
    endDate: "2006",
    company: "HSB Hochschule Bremen – City University of Applied Sciences",
    role: "Diplom Betriebswirt, Controlling and Informatics",
    location: "Bremen, Tyskland",
    description: "Kandidatexamen inom företagsekonomi med specialisering på controlling och informatik."
  },
  {
    startDate: "1994",
    endDate: "1996",
    company: "Schulzentrum des Sekundärbereichs II, Utbremen",
    role: "Mathematisch-technischer Assistent (MATA)",
    location: "Tyskland",
    description: "Vollschulische Berufsausbildung"
  },
    {
    startDate: "1990",
    endDate: "1993",
    company: "KGS Tarmstedt Europaschule",
    role: "Erweiterter Realschulabschluss",
    location: "Tyskland",
    description: "Gymnasial utbildning med europeisk inriktning."
  }
];

const certifications = [
  {
    startDate: "2010-01",
    endDate: null,
    company: "Oracle",
    role: "Oracle Certified Professional, Java SE 6 Programmer",
    location: "",
    description: "Professionell certifiering inom Java-programmering från Oracle."
  }
];

const skills = [
  {
    category: "Programmeringsspråk",
    items: ["Java", "Python", "Go", "SQL", "PL/SQL", "JavaScript"]
  },
  {
    category: "Backend & Ramverk",
    items: ["Spring Framework", "Spring MVC", "Spring Security", "Microservices", "REST API"]
  },
  {
    category: "Databaser & Verktyg",
    items: ["Oracle", "PostgreSQL", "Maven", "Git", "CI/CD", "Docker"]
  },
  {
    category: "Metodiker & Processer",
    items: ["Site Reliability Engineering", "Performance Engineering", "Agile", "DevOps"]
  },
  {
    category: "Språk",
    items: ["Tyska (modersmål)", "Svenska (avancerad)", "Norska (avancerad)", "Engelska (avancerad)", "Spanska (grundläggande)", "Franska (grundläggande)"]
  }
];
---

<Layout title="Per Abich - CV" robots={robotsMeta}>
  <div class="cv-container">
    <CVHeader
      name={personalInfo.name}
      title={personalInfo.title}
      email={personalInfo.email}
      phone={personalInfo.phone}
      location={personalInfo.location}
      linkedin={personalInfo.linkedin}
      github={personalInfo.github}
    />

    <main class="cv-content">
      <CVSection title="Arbetslivserfarenhet">
        <CVExperienceList experiences={experiences} />
      </CVSection>

      <CVSection title="Certifieringar">
        <CVExperienceList experiences={certifications} />
      </CVSection>

      <CVSection title="Utbildning">
        <CVExperienceList experiences={education} />
      </CVSection>

      <CVSection title="Kompetenser">
        <CVSkills skills={skills} />
      </CVSection>
    </main>
  </div>
</Layout>

<style>
  .cv-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem;
    font-family: 'Georgia', 'Times New Roman', serif;
    line-height: 1.6;
    color: #333;
    background: white;
  }

  .cv-content {
    display: flex;
    flex-direction: column;
    gap: 2.5rem;
  }

  @media print {
    .cv-container {
      max-width: none;
      padding: 1rem;
      font-size: 12px;
    }

    .cv-content {
      gap: 1.5rem;
    }
  }

  @media (max-width: 768px) {
    .cv-container {
      padding: 1rem;
    }
  }
</style>
